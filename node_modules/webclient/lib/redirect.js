'use strict';
var WebClient = require('../index');
var Url = require('url');

module.exports = function (opts, response) {
    opts.url = Url.resolve(response.requestUrl, response.caseless['location']);

    // Temporary redirect 307
    if (response.statusCode !== '307') {
        opts.method = 'GET';
        opts.referer = response.requestUrl;
        delete opts.form;
    }

    return WebClient(opts);
};
