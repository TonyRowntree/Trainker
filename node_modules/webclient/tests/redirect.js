var Hapi = require('hapi');

var server = new Hapi.Server();
server.connection({port: 8000});

server.route({
    method: 'GET',
    path: '/{name}',
    handler: function (req, reply) {
        console.log(req.method);
        console.log(req.url);
        console.log(req.raw.req.connection.remoteAddress)
        console.log(req.headers);
        console.log('-----------');

        setTimeout(function() {
            var query = Math.random().toString(36).slice(2);
            reply.redirect('/' + query);
        }, 700);
    }
});

server.route({
    method: 'POST',
    path: '/{name}',
    handler: function (req, reply) {
        console.log(req.method);
        console.log(req.url);
        console.log(req.raw.req.connection.remoteAddress)
        console.log(req.headers);
        console.log('-----------');

        setTimeout(function() {
            var query = Math.random().toString(36).slice(2);
            reply.redirect('/' + query);
        }, 1200);
    }
});

server.start(function () {
    console.log('Server running in', process.env.NODE_ENV, 'at: ', server.info.uri);
});
